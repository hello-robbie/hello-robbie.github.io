<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://hello-robbie.github.io/industrial-intrusion-tryhackme/Task%2024%20-%20Auth/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Task 24 - Auth - Hello Robbie</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Task 24 - Auth";
        var mkdocs_page_input_path = "industrial-intrusion-tryhackme/Task 24 - Auth.md";
        var mkdocs_page_url = "/industrial-intrusion-tryhackme/Task%2024%20-%20Auth/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Hello Robbie
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../resume/">Resume</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Blog</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../blog/honeypots/">Why I Use Honeypots</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../blog/webpaths/">Web App Default Paths</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Industrial Intrusion - TryHackMe CTF</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../Intro/">Intro</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Task%206%20-%20OSINT2/">Task 6 - OSINT2</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Task%208%20-%20Kaboom/">Task 8 - Kaboom</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Task%209%20-%20Brr%20v2/">Task 9 - Brr v2</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Task%2010%20-%20Brr%20v1/">Task 10 - Brr v1</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Task%2012%20-%20Poison/">Task 12 - Poison</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Task%2013%20-%20Orcam/">Task 13 - Orcam</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Task%2014%20-%20Backdoored%20Bus/">Task 14 - Backdoored Bus</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Task%2015%20-%20Chess%20Industry/">Task 15 - Chess Industry</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Task%2016%20-%20Under%20Construction/">Task 16 - Under Construction</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Task%2017%20-%20Klay/">Task 17 - Klay</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Task%2022%20-%20Rogue%20Poller/">Task 22 - Rogue Poller</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Task 24 - Auth</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#executive-summary">Executive Summary</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#phase-1-initial-recon-and-brute-force-attempts">Phase 1: Initial Recon and Brute Force Attempts</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#phase-2-local-binary-analysis">Phase 2: Local Binary Analysis</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#phase-3-reverse-engineering-the-binary">Phase 3: Reverse Engineering the Binary</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#phase-4-exploitation-and-flag-capture">Phase 4: Exploitation and Flag Capture</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#summary">Summary</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Task%2025%20-%20Access%20Granted/">Task 25 - Access Granted</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Task%2028%20-%20Start/">Task 28 - Start</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Task%2029%20-%20Industrial/">Task 29 - Industrial</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Task%2033%20-%20IndustrialChain/">Task 33 - Industrial Chain</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Task%2035%20-%20Uninterrupted%20Problem%20Supply/">Task 35 - Uninterrupted Problem Supply</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Task%2036%20-%20Mechacore%20Monitoring%20System/">Task 36 - Mechacore Monitoring System</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Hello Robbie</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Industrial Intrusion - TryHackMe CTF</li>
      <li class="breadcrumb-item active">Task 24 - Auth</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="ics-security-assessment-auth-challenge-reversing-writeup">ICS Security Assessment – Auth Challenge (Reversing) Writeup</h1>
<h2 id="executive-summary">Executive Summary</h2>
<p>The challenge involved reverse engineering a binary to recover an unlock code, which, when sent to a network service, revealed the flag. Although I initially tried brute force and string extraction, it was my teammate who ultimately reverse engineered the program using Ghidra to understand the transform logic and XOR encoding. By reversing the XOR process, we retrieved the correct unlock code and successfully completed the challenge.</p>
<hr />
<h2 id="phase-1-initial-recon-and-brute-force-attempts">Phase 1: Initial Recon and Brute Force Attempts</h2>
<p>The target exposed a network service on port 9005 that prompted for an unlock code:</p>
<pre><code class="language-bash">nc &lt;TARGET_IP&gt; 9005
</code></pre>
<p>The service responded with <code>[?] Enter unlock code:</code> and returned <code>[!] Access Denied!</code> for incorrect input.</p>
<p>I attempted brute force using a script:</p>
<pre><code class="language-bash">for i in $(seq -w 0000 9999); do
  echo &quot;$i&quot; | nc &lt;TARGET_IP&gt; 9005 | grep -v &quot;Access Denied&quot; &amp;&amp; echo &quot;TRY: $i&quot;
done
</code></pre>
<p>This yielded no results.</p>
<hr />
<h2 id="phase-2-local-binary-analysis">Phase 2: Local Binary Analysis</h2>
<p>TryHackMe provided a downloadable <code>auth</code> binary. Initial attempts to execute and trace it using <code>ltrace</code> and <code>strace</code> failed due to GLIBC version issues. Using <code>strings</code> on the binary showed references to <code>flag.txt</code> and the phrase <code>Access Granted</code>, hinting at internal validation logic.</p>
<hr />
<h2 id="phase-3-reverse-engineering-the-binary">Phase 3: Reverse Engineering the Binary</h2>
<p>My teammate opened the binary in Ghidra and analyzed the function responsible for checking the unlock code. They identified the following key points:</p>
<ul>
<li>The stored (correct) value was hardcoded: <code>0xefcdab8967452301</code></li>
<li>A function named <code>transform</code> XORed the user input with <code>0x55</code> byte-by-byte</li>
<li>To retrieve the correct input, the stored value needed to be XORed back with <code>0x55</code></li>
</ul>
<p>They wrote this Python script:</p>
<pre><code class="language-python">stored_hex = &quot;efcdab8967452301&quot;
stored_bytes = bytes.fromhex(stored_hex)
decoded = bytes([b ^ 0x55 for b in stored_bytes])
print(&quot;Unlock code:&quot;, decoded)
</code></pre>
<p>The result was the byte string:</p>
<pre><code>b'Tv\x102\xdc\xfe\x98\xba'
</code></pre>
<hr />
<h2 id="phase-4-exploitation-and-flag-capture">Phase 4: Exploitation and Flag Capture</h2>
<p>We passed the decoded bytes to the network service using:</p>
<pre><code class="language-bash">echo -ne '\x54\x76\x10\x32\xdc\xfe\x98\xba\n' | nc &lt;TARGET_IP&gt; 9005
</code></pre>
<p>This resulted in a successful unlock:</p>
<pre><code>[+] Access Granted! Flag: THM{simple_tostart_nice_done_mwww}
</code></pre>
<hr />
<h2 id="summary">Summary</h2>
<p>This challenge reinforced the importance of understanding simple XOR transformations in reversing challenges. While I pursued initial brute force and string analysis paths, it was my teammate’s skillful use of Ghidra and binary analysis that led us to the solution.</p>
<p><strong>Recommendations for Future Challenges:</strong></p>
<ul>
<li>Always inspect provided binaries for transform or obfuscation functions</li>
<li>Use Ghidra or similar tools to quickly decompile and analyze logic</li>
<li>When XOR is present, test both forward and reverse operations</li>
<li>Don’t ignore hardcoded hex values—they often hide the key</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../Task%2022%20-%20Rogue%20Poller/" class="btn btn-neutral float-left" title="Task 22 - Rogue Poller"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../Task%2025%20-%20Access%20Granted/" class="btn btn-neutral float-right" title="Task 25 - Access Granted">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../Task%2022%20-%20Rogue%20Poller/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../Task%2025%20-%20Access%20Granted/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
